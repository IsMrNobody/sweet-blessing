{"version":3,"file":"paymemtController.js","names":["creatOrder","req","res","order","intent","purchase_units","amount","currency_code","value","description","application_context","brand_name","landing_page","user_action","return_url","HOST","cancel_url","params","URLSearchParams","append","axios","post","headers","auth","username","PAYPAL_API_CLIENT","password","PAYPAL_API_SECRET","access_token","data","PAYPAL_API","Authorization","response","json","console","log","status","send","captureOrder","token","query","cancelOrder"],"sources":["../../dist/controllers/paymemtController.js"],"sourcesContent":["\r\nimport axios from \"axios\";\r\nimport {\r\n        PAYPAL_API,\r\n        PAYPAL_API_CLIENT,\r\n        PAYPAL_API_SECRET,\r\n        HOST\r\n       } from \"../config\";\r\n\r\nexport const creatOrder = async (req, res) => {\r\n    const order = {\r\n      intent: 'CAPTURE',\r\n      purchase_units: [\r\n        {\r\n          amount: {\r\n            currency_code: \"USD\",\r\n            value: 1\r\n          },\r\n          description: \"Venta de postres\",\r\n          //   items: [],\r\n          //   shipping: {},\r\n        }\r\n      ],\r\n      application_context: {\r\n        brand_name: `sweet-jesus`,\r\n        landing_page: 'NO_PREFERENCE',\r\n        user_action: 'PAY_NOW',\r\n        return_url: `${HOST}/capture-order`,\r\n        cancel_url: `${HOST}/cancel-order`\r\n      }\r\n    };\r\n\r\n    const params = new URLSearchParams()\r\n    params.append(\"grant_type\", \"client_credentials\")\r\n    \r\n    try {\r\n      // crear token para iniciar sesion\r\n        const { data: {access_token} } = await axios.post('https://api-m.sandbox.paypal.com/v1/oauth2/token', params, {\r\n            headers: {\r\n                'Content-Type': 'application/x-www-form-unlencoded'\r\n            },\r\n            auth: {\r\n              username: PAYPAL_API_CLIENT,\r\n              password: PAYPAL_API_SECRET\r\n            }\r\n        })\r\n        // console.log(access_token)\r\n\r\n        // enviar orden de pago\r\n        const response = await axios.post(`${PAYPAL_API}/v2/checkout/orders`, order, {\r\n        headers: {\r\n            Authorization: `Bearer ${access_token}`\r\n        }\r\n        })\r\n        // console.log(response.data)\r\n\r\n        res.json(response.data)\r\n    } catch (error) {\r\n        console.log('algo paso')\r\n        return res.status(500).send('Somenthing wrong')\r\n    }\r\n}\r\n\r\n// procesando pago\r\nexport const captureOrder = async (req, res) => {\r\n  const {token} = req.query\r\n  const response = await axios.post(`${PAYPAL_API}/v2/checkout/orders/${token}/capture`, {}, {\r\n    auth: {\r\n      username: PAYPAL_API_CLIENT,\r\n      password: PAYPAL_API_SECRET\r\n    }\r\n  })\r\n  console.log(response.data)\r\n  res.send('capturando orden')\r\n}\r\n\r\nexport const cancelOrder = (req, res) => {\r\n    res.send('canceling order')\r\n}"],"mappings":";;;;;;;;;AACA;;AACA;;;;+CADA,oJ;;;;;;AAQO,IAAMA,UAAU;EAAA,sEAAG,iBAAOC,GAAP,EAAYC,GAAZ;IAAA;;IAAA;MAAA;QAAA;UAAA;YAChBC,KADgB,GACR;cACZC,MAAM,EAAE,SADI;cAEZC,cAAc,EAAE,CACd;gBACEC,MAAM,EAAE;kBACNC,aAAa,EAAE,KADT;kBAENC,KAAK,EAAE;gBAFD,CADV;gBAKEC,WAAW,EAAE,kBALf,CAME;gBACA;;cAPF,CADc,CAFJ;cAaZC,mBAAmB,EAAE;gBACnBC,UAAU,eADS;gBAEnBC,YAAY,EAAE,eAFK;gBAGnBC,WAAW,EAAE,SAHM;gBAInBC,UAAU,YAAKC,YAAL,mBAJS;gBAKnBC,UAAU,YAAKD,YAAL;cALS;YAbT,CADQ;YAuBhBE,MAvBgB,GAuBP,IAAIC,eAAJ,EAvBO;YAwBtBD,MAAM,CAACE,MAAP,CAAc,YAAd,EAA4B,oBAA5B;YAxBsB;YAAA;YAAA,OA4BqBC,iBAAA,CAAMC,IAAN,CAAW,kDAAX,EAA+DJ,MAA/D,EAAuE;cAC1GK,OAAO,EAAE;gBACL,gBAAgB;cADX,CADiG;cAI1GC,IAAI,EAAE;gBACJC,QAAQ,EAAEC,yBADN;gBAEJC,QAAQ,EAAEC;cAFN;YAJoG,CAAvE,CA5BrB;;UAAA;YAAA;YA4BHC,YA5BG,qBA4BVC,IA5BU,CA4BHD,YA5BG;YAAA;YAAA,OAwCKR,iBAAA,CAAMC,IAAN,WAAcS,kBAAd,0BAA+C3B,KAA/C,EAAsD;cAC7EmB,OAAO,EAAE;gBACLS,aAAa,mBAAYH,YAAZ;cADR;YADoE,CAAtD,CAxCL;;UAAA;YAwCZI,QAxCY;YA6ClB;YAEA9B,GAAG,CAAC+B,IAAJ,CAASD,QAAQ,CAACH,IAAlB;YA/CkB;YAAA;;UAAA;YAAA;YAAA;YAiDlBK,OAAO,CAACC,GAAR,CAAY,WAAZ;YAjDkB,iCAkDXjC,GAAG,CAACkC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kBAArB,CAlDW;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAH;;EAAA,gBAAVrC,UAAU;IAAA;EAAA;AAAA,GAAhB,C,CAsDP;;;;;AACO,IAAMsC,YAAY;EAAA,uEAAG,kBAAOrC,GAAP,EAAYC,GAAZ;IAAA;IAAA;MAAA;QAAA;UAAA;YACnBqC,KADmB,GACVtC,GAAG,CAACuC,KADM,CACnBD,KADmB;YAAA;YAAA,OAEHnB,iBAAA,CAAMC,IAAN,WAAcS,kBAAd,iCAA+CS,KAA/C,eAAgE,EAAhE,EAAoE;cACzFhB,IAAI,EAAE;gBACJC,QAAQ,EAAEC,yBADN;gBAEJC,QAAQ,EAAEC;cAFN;YADmF,CAApE,CAFG;;UAAA;YAEpBK,QAFoB;YAQ1BE,OAAO,CAACC,GAAR,CAAYH,QAAQ,CAACH,IAArB;YACA3B,GAAG,CAACmC,IAAJ,CAAS,kBAAT;;UAT0B;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAH;;EAAA,gBAAZC,YAAY;IAAA;EAAA;AAAA,GAAlB;;;;AAYA,IAAMG,WAAW,GAAG,SAAdA,WAAc,CAACxC,GAAD,EAAMC,GAAN,EAAc;EACrCA,GAAG,CAACmC,IAAJ,CAAS,iBAAT;AACH,CAFM"}